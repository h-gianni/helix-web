# Helix - Team Performance Management Platform

## Project Overview
Helix is a Next.js-based web application designed for managing team performance and initiatives. The platform allows organizations to track team member performance, set goals, and manage performance ratings across different initiatives.

## Tech Stack

### Core Technologies
- **Framework**: Next.js 14.2.17 with App Router
- **Language**: TypeScript
- **Database**: Prisma ORM with Neon (Serverless Postgres)
- **Authentication**: Clerk
- **UI Components**: shadcn/ui (Radix UI based)
- **Styling**: TailwindCSS with custom token system
- **Documentation**: Storybook

### Key Dependencies
- React 18
- Prisma Client & Neon Adapter
- Clerk Next.js & SDK
- Lucide React (Icons)
- CVA (Class Variance Authority)
- Radix UI Components
- TailwindCSS with custom plugins

## Project Structure

```
helix-app/
├── .next/               # Next.js build output
├── src/
│   ├── app/            # App Router pages and API routes
│   │   ├── api/        # API route handlers
│   │   ├── auth/       # Authentication related pages
│   │   ├── dashboard/  # Dashboard pages and components
│   │   └── settings/   # Settings pages and components
│   ├── components/     # Shared React components
│   │   ├── ui/         # Base UI components (shadcn/ui)
│   │   └── theme/      # Theming components
│   ├── lib/           # Utility functions and types
│   └── styles/        # Global styles and design tokens
├── prisma/            # Database schema and migrations
└── public/           # Static assets
```

## Architecture

### Component Architecture
The project follows a component-based architecture with three main types of components:

1. **Base UI Components** (`/components/ui/`)
   - Built on shadcn/ui and Radix UI
   - Follows atomic design principles
   - Fully themed and customizable
   - Examples: Button, Card, Dialog

2. **Feature Components** (`/app/**/components/`)
   - Specific to feature areas
   - Composed of base UI components
   - Contains business logic
   - Examples: PerformanceRatingModal, TeamPerformanceSummary

3. **Layout Components** (`/app/**/layout.tsx`)
   - Handle page layouts and navigation
   - Manage shared UI elements
   - Control responsive behavior

### Design System

#### Theme Structure
The project uses a sophisticated design token system located in `/src/styles/tokens/`:

```
styles/tokens/
├── foundations.css    # Base design tokens
├── semantic.css      # Semantic token mappings
├── typography.css    # Typography system
└── themes/          # Theme variations
    ├── light.css
    └── dark.css
```

#### Color System
- Primary: Cobalt blue-based palette
- Accent: Blue violet palette
- Semantic colors: Success, Warning, Danger, Info
- Neutral: Grayscale palette

#### Component Styling
- Uses CSS Modules with TailwindCSS
- Custom utility classes via Tailwind plugins
- Consistent spacing and sizing system
- Dark mode support via `data-theme` attribute

### Database Schema
The main entities in the system include:

- **Teams**: Core organizational unit
- **Members**: Team members with roles and permissions
- **Initiatives**: Performance tracking categories
- **Scores**: Performance ratings and feedback
- **Goals**: Member-specific objectives

### Authentication & Authorization
- Clerk.js handles user authentication
- Role-based access control for team management
- API route protection via middleware
- Session management through Clerk

## Development Guidelines

### Getting Started
1. Clone the repository
2. Install dependencies: `npm install`
3. Copy `.env.example` to `.env` and configure variables
4. Run database migrations: `npx prisma migrate dev`
5. Start development server: `npm run dev`

### Code Style
- TypeScript strict mode enabled
- ESLint configuration for Next.js
- Prettier for code formatting
- Component patterns:
  - Functional components with hooks
  - Props interface definitions
  - JSDoc comments for complex functions

### State Management
- React Context for theme and auth state
- Local component state with hooks
- Server state management through API routes
- Optimistic updates for better UX

### API Structure
- RESTful API routes under `/api`
- Consistent response format:
  ```typescript
  interface ApiResponse<T> {
    success: boolean;
    data?: T;
    error?: string;
  }
  ```
- Error handling middleware
- Rate limiting on sensitive routes

### Testing
- Jest for unit testing
- React Testing Library for component tests
- Storybook for component documentation
- E2E testing setup pending

### Performance Considerations
- Image optimization via Next.js
- Dynamic imports for code splitting
- Serverless function optimization
- Proper database indexing
- Caching strategies implementation

### Deployment
- Vercel-optimized setup
- Environment variable management
- Database migration process
- CI/CD pipeline configuration

## Future Considerations
1. Implementing real-time updates
2. Enhanced analytics dashboard
3. Export functionality
4. Mobile app development
5. Integration with third-party services

## User Journeys & Page Responsibilities

### Core User Journeys

#### 1. Authentication Flow
- Entry Point: `/` (redirects to `/sign-in` if not authenticated)
- Components: Clerk authentication UI
- API Routes: `/api/auth/webhook` - Handles Clerk authentication webhooks
- User Experience:
  1. User arrives at the platform
  2. Signs in via Clerk (email or Google)
  3. Gets redirected to dashboard on success

#### 2. Dashboard Experience
- Page: `/dashboard/page.tsx`
- Key Components:
  - `_performanceRatingModal.tsx`: Handles performance rating input
  - `_performersByCategory.tsx`: Displays team members grouped by performance
  - `_starRating.tsx`: Star rating input component
- API Routes: `/api/dashboard/performers` - Fetches aggregated performance data
- User Experience:
  1. Views overall team performance metrics
  2. Sees performers categorized by rating
  3. Can quickly add new ratings
  4. Access to key actions (rate member, add feedback)

#### 3. Team Management
- Base Page: `/dashboard/teams/page.tsx`
- Team Details: `/dashboard/teams/[teamId]/page.tsx`
- Key Components:
  - `_teamCreateModal.tsx`: Team creation form
  - `_emptyTeamsView.tsx`: Initial team setup guide
  - `_teamEditModal.tsx`: Team editing interface
  - `_teamPerformanceSummary.tsx`: Team performance overview
- API Routes:
  - `/api/teams` - CRUD operations for teams
  - `/api/teams/[teamId]/members` - Team member management
  - `/api/teams/[teamId]/performance` - Team performance metrics
- User Experience:
  1. Creates/manages teams
  2. Adds/removes team members
  3. Views team performance metrics
  4. Configures team settings

#### 4. Member Management
- Page: `/dashboard/teams/[teamId]/members/[memberId]/page.tsx`
- Key Components:
  - `_editMemberModal.tsx`: Member detail editing
  - `_ratingsSection.tsx`: Member's rating history
- API Routes:
  - `/api/teams/[teamId]/members/[memberId]` - Member CRUD operations
  - `/api/teams/[teamId]/members/[memberId]/ratings` - Member ratings
- User Experience:
  1. Views detailed member profile
  2. Manages member details
  3. Reviews rating history
  4. Provides performance feedback

#### 5. Settings Management
- Page: `/dashboard/settings/page.tsx`
- Key Components:
  - `_initiativeModal.tsx`: Initiative creation/editing
  - `_initiativesSection.tsx`: Initiative management
  - `_profileModal.tsx`: User profile editing
  - `_profileSelection.tsx`: Profile section UI
  - `_teamInitiativesConfig.tsx`: Team initiative configuration
- API Routes:
  - `/api/initiatives` - Initiative CRUD operations
  - `/api/user/profile` - User profile management
  - `/api/teams/[teamId]/initiatives` - Team initiative associations
- User Experience:
  1. Configures personal profile
  2. Manages performance initiatives
  3. Configures team settings
  4. Sets up rating criteria

### Page & API Responsibilities

#### Pages

##### Dashboard Module (`/dashboard`)
- `page.tsx`: Main dashboard
  - Displays performance overview
  - Shows categorized team members
  - Provides quick actions

##### Teams Module (`/dashboard/teams`)
- `page.tsx`: Teams listing
  - Shows all accessible teams
  - Team creation interface
- `[teamId]/page.tsx`: Team details
  - Team performance metrics
  - Member management
  - Team settings
- `[teamId]/members/[memberId]/page.tsx`: Member details
  - Individual performance view
  - Rating history
  - Member management

##### Settings Module (`/dashboard/settings`)
- `page.tsx`: Settings dashboard
  - Profile management
  - Initiative configuration
  - System settings

#### API Routes

##### Authentication (`/api/auth`)
- `webhook/route.ts`: Clerk webhook handler
  - User creation/update
  - Session management

##### Dashboard (`/api/dashboard`)
- `performers/route.ts`: Performance data
  - Aggregated metrics
  - Performance categories

##### Teams (`/api/teams`)
- `route.ts`: Team CRUD
  - Team creation
  - Team listing
  - Team updates
- `[teamId]/route.ts`: Team operations
  - Team details
  - Team deletion
- `[teamId]/members/route.ts`: Member management
  - Member addition
  - Member listing
- `[teamId]/performance/route.ts`: Team metrics
  - Performance data
  - Analytics

##### Initiatives (`/api/initiatives`)
- `route.ts`: Initiative management
  - Initiative CRUD
  - Initiative configuration
- `[initiativeId]/route.ts`: Initiative operations
  - Initiative updates
  - Initiative metrics

##### User (`/api/user`)
- `profile/route.ts`: Profile management
  - Profile updates
  - Preferences

### Navigation Flow
1. **Entry**: Authentication → Dashboard
2. **Main Navigation**:
   - Dashboard → Teams/Members/Settings
   - Teams → Team Details → Member Details
   - Settings → Various Configuration Sections
3. **Action Flows**:
   - Rating Flow: Dashboard/Team → Rating Modal → Confirmation
   - Team Creation: Teams → Create Modal → Team Details
   - Member Addition: Team Details → Add Member → Member Details

## Contributing
1. Branch naming: `feature/`, `bugfix/`, `hotfix/`
2. Pull request template usage
3. Code review requirements
4. Testing requirements
5. Documentation updates

## Support
- Internal documentation
- Issue tracking process
- Security vulnerability reporting
- Performance monitoring setup

# Updates to Feature Components Section

### Feature Components (`/app/**/components/`)
Add under existing examples:
- `_teamPerformanceView.tsx`: Reusable component for displaying team member performance data
  - Provides consistent display of member information across different views
  - Used in both team details and performance category views
  - Includes configurable avatar and action displays
  - Handles member navigation and actions

### Component Updates

#### TeamPerformanceView Component
Located in `/app/dashboard/_components/TeamPerformanceView.tsx`
- **Purpose**: Provides a standardized way to display team member performance data across different views in the application
- **Features**:
  - Consistent display of member information:
    - Name (with navigation to member details)
    - Job Title
    - Performance Rating
    - Performance Category
    - Rating Display (star-based visualization)
  - Configurable display options:
    - Optional avatar display
    - Optional action menu
  - Standardized navigation through member profiles
  - Sorting functionality for member display
- **Usage Contexts**:
  - Performance category views (`_performersByCategory.tsx`)
  - Team detail views (`_teamPerformanceSummary.tsx`)
  - Any future views requiring member performance display

#### Integration
The component replaces duplicate member display logic in:
- `_performersByCategory.tsx`
- `_teamPerformanceSummary.tsx`

This consolidation ensures:
- Consistent user experience across the application
- Reduced code duplication
- Centralized maintenance
- Standardized performance category display

### Component Props
```typescript
interface TeamPerformanceViewProps {
  members: MemberPerformance[];
  showAvatar?: boolean;
  showActions?: boolean;
  onMemberDelete?: (member: MemberPerformance) => void;
}
```

### Shared Types
Located in `/app/dashboard/types/member.ts`:
```typescript
interface MemberPerformance {
  id: string;
  name: string;
  title: string | null;
  teamId: string;
  teamName?: string;
  averageRating: number;
  ratingsCount: number;
}

interface PerformanceCategory {
  label: string;
  minRating: number;
  maxRating: number;
  className: string;
  Icon: LucideIcon;
  description?: string;
}
```

### Navigation
The component implements standardized navigation paths:
- Member details: `/dashboard/teams/[teamId]/members/[memberId]`
- Uses Next.js Link component for optimal client-side navigation

### User Experience Improvements
- Consistent interface across different views
- Standardized interaction patterns
- Improved navigation through member profiles
- Unified performance category visualization

This documentation is maintained by the Helix development team and should be updated as the project evolves.
